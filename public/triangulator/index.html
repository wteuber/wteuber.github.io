<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triangulator</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="toolbar">
        <label for="imageLoader" class="toolbar-btn" title="Open Image">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" fill="currentColor">
                <g id="g521">
                    <path fill="#231F20"
                        d="M 60,0 H 4 C 1.789,0 0,1.789 0,4 v 56 c 0,2.211 1.789,4 4,4 h 56 c 2.211,0 4,-1.789 4,-4 V 4 C 64,1.789 62.211,0 60,0 Z M 8,8 h 48 v 32.688 l -9.113,-9.113 c -1.562,-1.559 -4.094,-1.559 -5.656,0 L 16.805,56 H 8 Z"
                        style="fill:#252525;fill-opacity:1;stroke:none" />
                    <circle fill="#231F20" cx="24" cy="24" r="8" style="fill:#252525;fill-opacity:1;stroke:none" />
                </g>
            </svg>
        </label>
        <input type="file" id="imageLoader" name="imageLoader" accept="image/*" />
        <label for="importMesh" class="toolbar-btn" title="Import Mesh from JSON">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M0 0h24v24H0z" fill="none" />
                <path
                    d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V6h5.17l2 2H20v10z" />
            </svg>
        </label>
        <input type="file" id="importMesh" accept=".json" />
        <button id="exportMeshBtn" class="toolbar-btn" title="Export Mesh as JSON">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M0 0h24v24H0z" fill="none" />
                <path
                    d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z" />
            </svg>
        </button>

        <div class="separator"></div>

        <button id="undoBtn" class="toolbar-btn" title="Undo (Ctrl+Z)">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M0 0h24v24H0z" fill="none" />
                <path
                    d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z" />
            </svg>
        </button>
        <button id="redoBtn" class="toolbar-btn" title="Redo (Ctrl+Y)">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M0 0h24v24H0z" fill="none" />
                <path
                    d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.96 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z" />
            </svg>
        </button>

        <div class="separator"></div>

        <button id="toggleImageBtn" class="toolbar-btn" title="Toggle Image Visibility">
            <svg class="icon-eye" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" fill="currentColor">
                <g id="g521">
                    <path fill="#231F20"
                        d="M 60,0 H 4 C 1.789,0 0,1.789 0,4 v 56 c 0,2.211 1.789,4 4,4 h 56 c 2.211,0 4,-1.789 4,-4 V 4 C 64,1.789 62.211,0 60,0 Z M 8,8 h 48 v 32.688 l -9.113,-9.113 c -1.562,-1.559 -4.094,-1.559 -5.656,0 L 16.805,56 H 8 Z"
                        id="path517" style="fill:#252525;fill-opacity:1;stroke:none" />
                    <circle fill="#231F20" cx="24" cy="24" r="8" id="circle519"
                        style="fill:#252525;fill-opacity:1;stroke:none" />
                </g>
            </svg>
            <svg class="icon-eye-slash" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" fill="currentColor"
                style="display: none;">
                <g id="g521">
                    <path fill="#231F20"
                        d="M 60,0 H 4 C 1.789,0 0,1.789 0,4 v 56 c 0,2.211 1.789,4 4,4 h 56 c 2.211,0 4,-1.789 4,-4 V 4 C 64,1.789 62.211,0 60,0 Z M 8,8 h 48 v 32.688 l -9.113,-9.113 c -1.562,-1.559 -4.094,-1.559 -5.656,0 L 16.805,56 H 8 Z"
                        id="path517" style="fill:#4d4d4d;fill-opacity:1;stroke:none" />
                    <circle fill="#231F20" cx="24" cy="24" r="8" id="circle519"
                        style="fill:#4d4d4d;fill-opacity:1;stroke:none" />
                </g>
                <path d="M -0.02878446,-0.05756893 23.977459,24.006244 22.336744,23.977459 -0.02878446,1.9285591 Z"
                    id="path7756" style="fill:#000000" class="UnoptimicedTransforms"
                    transform="matrix(2.6666666,0,0,2.6666666,0.02475856,0.02151317)" />
                <path
                    style="fill:#ffffff;fill-opacity:0.994197;fill-rule:nonzero;stroke:#ffffff;stroke-width:0.021;stroke-linecap:round;stroke-linejoin:round"
                    d="M -0.02878446,-0.05756893 C 5.4455084,5.4298519 14.040644,14.045599 23.977459,24.006244 c -0.512141,-0.009 -1.076428,-0.01888 -1.640715,-0.02878 C 14.644622,16.394234 6.9525002,8.8110098 -0.02878446,1.9285591 c 0,-0.8221106 0,-1.53321891 0,-1.98612803 z m 0,0 c 0,0.45290912 0,1.16401743 0,1.98612803 C 6.9525002,8.8110098 14.644622,16.394234 22.336744,23.977459 c 0.564287,0.0099 1.128574,0.0198 1.640715,0.02878 C 14.040644,14.045599 5.4455084,5.4298519 -0.02878446,-0.05756893 Z"
                    id="path7750" class="UnoptimicedTransforms"
                    transform="matrix(2.6666666,0,0,2.6666666,0.02475856,0.02151317)" />
                <path d="M 0,-0.05756893 24.035028,24.092597 23.977459,22.451882 1.7270679,0 Z" id="path7872"
                    style="fill:#ffffff" class="UnoptimicedTransforms"
                    transform="matrix(2.6666666,0,0,2.6666666,0.02475856,0.02151317)" />
                <path
                    style="fill:#ffffff;fill-opacity:0.994197;fill-rule:nonzero;stroke:none;stroke-width:0.021;stroke-linecap:round;stroke-linejoin:round"
                    d="M 0,-0.05756893 C 5.4808568,5.4495435 14.086298,14.096209 24.035028,24.092597 24.017058,23.580456 23.997259,23.016169 23.977459,22.451882 16.324936,14.730061 8.672413,7.0082395 1.7270679,0 1.0121891,-0.02382929 0.39383403,-0.04444113 0,-0.05756893 Z m 0,0 C 0.39383403,-0.04444113 1.0121891,-0.02382929 1.7270679,0 8.672413,7.0082395 16.324936,14.730061 23.977459,22.451882 c 0.0198,0.564287 0.0396,1.128574 0.05757,1.640715 C 14.086298,14.096209 5.4808568,5.4495435 0,-0.05756893 Z"
                    id="path7866" class="UnoptimicedTransforms"
                    transform="matrix(2.6666666,0,0,2.6666666,0.02475856,0.02151317)" />
            </svg>
        </button>
        <button id="toggleTrianglesBtn" class="toolbar-btn" title="Toggle Filled Triangles Visibility">
            <svg class="icon-eye" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="M 12,2.59009 V 13.6101 l -9.35,6.54 c -0.85,-1.01 -0.9,-2.54 0.05,-4.25 l 3.12,-5.61 2.94,-5.29001 c 0.89,-1.6 2.06,-2.41 3.24,-2.41 z"
                    fill="#292d32" id="path388" />
                <path opacity="0.6"
                    d="m 21.3504,20.1501 c -0.65,0.79 -1.78,1.26 -3.29,1.26 H 5.94039 c -1.51,0 -2.64,-0.47 -3.29,-1.26 l 9.35001,-6.54 z"
                    fill="#292d32" id="path390" />
                <path opacity="0.4"
                    d="M 21.35,20.1501 12,13.6101 V 2.59009 c 1.18,0 2.35,0.81 3.24,2.41 l 2.94,5.29001 3.12,5.61 c 0.95,1.71 0.9,3.24 0.05,4.25 z"
                    fill="#292d32" id="path392" />
            </svg>
            <svg class="icon-eye-slash" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
                style="display: none;">
                <path
                    d="M 12,2.59009 V 13.6101 l -9.35,6.54 c -0.85,-1.01 -0.9,-2.54 0.05,-4.25 l 3.12,-5.61 2.94,-5.29001 c 0.89,-1.6 2.06,-2.41 3.24,-2.41 z"
                    fill="#292D32" id="path388" style="fill:#292d32;fill-opacity:0.68" />
                <path opacity="0.6"
                    d="m 21.3504,20.1501 c -0.65,0.79 -1.78,1.26 -3.29,1.26 H 5.94039 c -1.51,0 -2.64,-0.47 -3.29,-1.26 l 9.35001,-6.54 z"
                    fill="#292D32" id="path390" style="fill:#292d32;fill-opacity:0.68" />
                <path opacity="0.4"
                    d="M 21.35,20.1501 12,13.6101 V 2.59009 c 1.18,0 2.35,0.81 3.24,2.41 l 2.94,5.29001 3.12,5.61 c 0.95,1.71 0.9,3.24 0.05,4.25 z"
                    fill="#292D32" id="path392" style="fill:#292d32;fill-opacity:0.68" />
                <path d="M -0.02878446,-0.05756893 23.977459,24.006244 22.336744,23.977459 -0.02878446,1.9285591 Z"
                    id="path7756" style="fill:#000000" class="UnoptimicedTransforms" />
                <path
                    style="fill:#ffffff;fill-opacity:0.994197;fill-rule:nonzero;stroke:#ffffff;stroke-width:0.021;stroke-linecap:round;stroke-linejoin:round"
                    d="M -0.02878446,-0.05756893 C 5.4455084,5.4298519 14.040644,14.045599 23.977459,24.006244 c -0.512141,-0.009 -1.076428,-0.01888 -1.640715,-0.02878 C 14.644622,16.394234 6.9525002,8.8110098 -0.02878446,1.9285591 c 0,-0.8221106 0,-1.53321891 0,-1.98612803 z m 0,0 c 0,0.45290912 0,1.16401743 0,1.98612803 C 6.9525002,8.8110098 14.644622,16.394234 22.336744,23.977459 c 0.564287,0.0099 1.128574,0.0198 1.640715,0.02878 C 14.040644,14.045599 5.4455084,5.4298519 -0.02878446,-0.05756893 Z"
                    id="path7750" class="UnoptimicedTransforms" />
                <path d="M 0,-0.05756893 24.035028,24.092597 23.977459,22.451882 1.7270679,0 Z" id="path7872"
                    style="fill:#ffffff" class="UnoptimicedTransforms" />
                <path
                    style="fill:#ffffff;fill-opacity:0.994197;fill-rule:nonzero;stroke:none;stroke-width:0.021;stroke-linecap:round;stroke-linejoin:round"
                    d="M 0,-0.05756893 C 5.4808568,5.4495435 14.086298,14.096209 24.035028,24.092597 24.017058,23.580456 23.997259,23.016169 23.977459,22.451882 16.324936,14.730061 8.672413,7.0082395 1.7270679,0 1.0121891,-0.02382929 0.39383403,-0.04444113 0,-0.05756893 Z m 0,0 C 0.39383403,-0.04444113 1.0121891,-0.02382929 1.7270679,0 8.672413,7.0082395 16.324936,14.730061 23.977459,22.451882 c 0.0198,0.564287 0.0396,1.128574 0.05757,1.640715 C 14.086298,14.096209 5.4808568,5.4495435 0,-0.05756893 Z"
                    id="path7866" class="UnoptimicedTransforms" />
            </svg>
        </button>
        <button id="toggleWireframeBtn" class="toolbar-btn" title="Toggle Triangle Mesh Visibility">
            <svg class="icon-eye" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="M 12,21.41 H 5.93999 c -3.47,0 -4.92,-2.48 -3.24,-5.51 l 3.12,-5.62 2.94,-5.27997 c 1.78001,-3.21 4.70001,-3.21 6.48001,0 l 2.94,5.28997 3.12,5.62 c 1.68,3.03 0.22,5.51 -3.24,5.51 H 12 Z"
                    stroke="#292D32" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" id="path645"
                    style="display:inline;fill:none;stroke:#130000;stroke-opacity:1" />
                <path d="M 21.44,20 12,13.39 2.56,20" stroke="#292D32" stroke-width="1.5" stroke-linecap="round"
                    stroke-linejoin="round" id="path647"
                    style="display:inline;fill:none;stroke:#130000;stroke-opacity:1" />
                <path d="M 12,3 V 13.39" stroke="#292D32" stroke-width="1.5" stroke-linecap="round"
                    stroke-linejoin="round" id="path649"
                    style="display:inline;fill:none;stroke:#130000;stroke-opacity:1" />
            </svg>
            <svg class="icon-eye-slash" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
                style="display: none;">
                <path
                    d="M 12,21.41 H 5.93999 c -3.47,0 -4.92,-2.48 -3.24,-5.51 l 3.12,-5.62 2.94,-5.27997 c 1.78001,-3.21 4.70001,-3.21 6.48001,0 l 2.94,5.28997 3.12,5.62 c 1.68,3.03 0.22,5.51 -3.24,5.51 H 12 Z"
                    stroke="#292D32" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" id="path645"
                    style="display:inline;fill:none;stroke:#444444;stroke-opacity:1" />
                <path d="M 21.44,20 12,13.39 2.56,20" stroke="#292D32" stroke-width="1.5" stroke-linecap="round"
                    stroke-linejoin="round" id="path647"
                    style="display:inline;fill:none;stroke:#444444;stroke-opacity:1" />
                <path d="M 12,3 V 13.39" stroke="#292D32" stroke-width="1.5" stroke-linecap="round"
                    stroke-linejoin="round" id="path649"
                    style="display:inline;fill:none;stroke:#444444;stroke-opacity:1" />
                <path d="M -0.02878446,-0.05756893 23.977459,24.006244 22.336744,23.977459 -0.02878446,1.9285591 Z"
                    id="path7756" style="display:inline;fill:#000000" class="UnoptimicedTransforms"
                    transform="translate(0.00928446,0.00806744)" />
                <path
                    style="display:inline;fill:#ffffff;fill-opacity:0.994197;fill-rule:nonzero;stroke:#ffffff;stroke-width:0.021;stroke-linecap:round;stroke-linejoin:round"
                    d="M -0.02878446,-0.05756893 C 5.4455084,5.4298519 14.040644,14.045599 23.977459,24.006244 c -0.512141,-0.009 -1.076428,-0.01888 -1.640715,-0.02878 C 14.644622,16.394234 6.9525002,8.8110098 -0.02878446,1.9285591 c 0,-0.8221106 0,-1.53321891 0,-1.98612803 z m 0,0 c 0,0.45290912 0,1.16401743 0,1.98612803 C 6.9525002,8.8110098 14.644622,16.394234 22.336744,23.977459 c 0.564287,0.0099 1.128574,0.0198 1.640715,0.02878 C 14.040644,14.045599 5.4455084,5.4298519 -0.02878446,-0.05756893 Z"
                    id="path7750" class="UnoptimicedTransforms" transform="translate(0.00928446,0.00806744)" />
                <path d="M 0,-0.05756893 24.035028,24.092597 23.977459,22.451882 1.7270679,0 Z" id="path7872"
                    style="display:inline;fill:#ffffff" class="UnoptimicedTransforms"
                    transform="translate(0.00928446,0.00806744)" />
                <path
                    style="display:inline;fill:#ffffff;fill-opacity:0.994197;fill-rule:nonzero;stroke:none;stroke-width:0.021;stroke-linecap:round;stroke-linejoin:round"
                    d="M 0,-0.05756893 C 5.4808568,5.4495435 14.086298,14.096209 24.035028,24.092597 24.017058,23.580456 23.997259,23.016169 23.977459,22.451882 16.324936,14.730061 8.672413,7.0082395 1.7270679,0 1.0121891,-0.02382929 0.39383403,-0.04444113 0,-0.05756893 Z m 0,0 C 0.39383403,-0.04444113 1.0121891,-0.02382929 1.7270679,0 8.672413,7.0082395 16.324936,14.730061 23.977459,22.451882 c 0.0198,0.564287 0.0396,1.128574 0.05757,1.640715 C 14.086298,14.096209 5.4808568,5.4495435 0,-0.05756893 Z"
                    id="path7866" class="UnoptimicedTransforms" transform="translate(0.00928446,0.00806744)" />
            </svg>
        </button>

        <div class="separator"></div>

        <button id="exportTrianglesBtn" class="toolbar-btn" title="Export Triangles as PNG">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="m 3.1868044,16.072028 v 1 3 c 0,1.1046 0.89543,2 2,2 H 19.186804 c 1.1046,0 2,-0.8954 2,-2 v -3 -1"
                    stroke="#323232" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="path136"
                    style="fill:none" />
                <path d="m 9.2556935,16.354778 2.9129995,2.913 v 0 c 0.048,0.048 0.126,0.048 0.174,0 v 0 l 2.913,-2.913"
                    stroke="#323232" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="path134"
                    style="fill:none" />
                <g id="g521" transform="matrix(0.1867463,0,0,0.1867463,6.0723551,1.7216031)">
                    <path fill="#231F20"
                        d="M 60,0 H 4 C 1.789,0 0,1.789 0,4 v 56 c 0,2.211 1.789,4 4,4 h 56 c 2.211,0 4,-1.789 4,-4 V 4 C 64,1.789 62.211,0 60,0 Z M 8,8 h 48 v 32.688 l -9.113,-9.113 c -1.562,-1.559 -4.094,-1.559 -5.656,0 L 16.805,56 H 8 Z"
                        id="path517" style="fill:#252525;fill-opacity:1;stroke:none" />
                    <circle fill="#231F20" cx="24" cy="24" r="8" id="circle519"
                        style="fill:#252525;fill-opacity:1;stroke:none" />
                </g>
            </svg>
        </button>
        <button id="exportTrianglesSvgBtn" class="toolbar-btn" title="Export Triangles as SVG">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="m 3.1868044,16.072028 v 1 3 c 0,1.1046 0.89543,2 2,2 H 19.186804 c 1.1046,0 2,-0.8954 2,-2 v -3 -1"
                    stroke="#323232" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="path136"
                    style="fill:none" />
                <path d="m 9.2556935,16.354778 2.9129995,2.913 v 0 c 0.048,0.048 0.126,0.048 0.174,0 v 0 l 2.913,-2.913"
                    stroke="#323232" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="path134"
                    style="fill:none" />
                <path
                    d="M 12.3822,2.0804428 V 8.9198217 L 6.5792841,12.978759 C 6.0517466,12.35192 6.0207147,11.402352 6.6103196,10.34107 L 8.5466933,6.859321 10.371353,3.5761677 c 0.552364,-0.9930123 1.278504,-1.4957249 2.010851,-1.4957249 z"
                    fill="#292d32" id="path388" style="stroke-width:0.620633" />
                <path opacity="0.6"
                    d="m 18.185364,12.978759 c -0.403411,0.4903 -1.104725,0.781997 -2.041881,0.781997 H 8.621408 c -0.9371556,0 -1.6384702,-0.291697 -2.0418812,-0.781997 L 12.382448,8.9198217 Z"
                    fill="#292d32" id="path390" style="stroke-width:0.620633" />
                <path opacity="0.4"
                    d="M 18.185116,12.978759 12.3822,8.9198217 V 2.0804428 c 0.732347,0 1.458487,0.5027126 2.01085,1.4957249 l 1.82466,3.2831533 1.936375,3.481749 c 0.589601,1.061282 0.558569,2.01085 0.03103,2.637689 z"
                    fill="#292d32" id="path392" style="stroke-width:0.620633" />
            </svg>
        </button>
        <button id="exportWireframeSvgBtn" class="toolbar-btn" title="Export Wireframe as SVG">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path
                    d="m 12.179649,14.057803 h -3.7689 c -2.1580961,0 -3.0598941,-1.542386 -2.0150523,-3.426833 L 8.3361174,7.135725 10.164591,3.8519545 c 1.107041,-1.9963942 2.923075,-1.9963942 4.03011,0 l 1.828473,3.2899895 1.940421,3.495245 c 1.044842,1.884447 0.136821,3.426833 -2.015052,3.426833 h -3.768894 z"
                    stroke="#292D32" stroke-width="0.932894" stroke-linecap="round" stroke-linejoin="round" id="path645"
                    style="display:inline;fill:none;stroke:#130000;stroke-opacity:1" />
                <path d="M 18.050665,13.180882 12.179649,9.069926 6.3086329,13.180882" stroke="#292D32"
                    stroke-width="0.932894" stroke-linecap="round" stroke-linejoin="round" id="path647"
                    style="display:inline;fill:none;stroke:#130000;stroke-opacity:1" />
                <path d="M 12.179649,2.6080766 V 9.069926" stroke="#292D32" stroke-width="0.932894"
                    stroke-linecap="round" stroke-linejoin="round" id="path649"
                    style="display:inline;fill:none;stroke:#130000;stroke-opacity:1" />
                <path
                    d="m 3.1868044,16.072028 v 1 3 c 0,1.1046 0.89543,2 2,2 H 19.186804 c 1.1046,0 2,-0.8954 2,-2 v -3 -1"
                    stroke="#323232" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="path136"
                    style="fill:none" />
                <path d="m 9.2556935,16.354778 2.9129995,2.913 v 0 c 0.048,0.048 0.126,0.048 0.174,0 v 0 l 2.913,-2.913"
                    stroke="#323232" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="path134"
                    style="fill:none" />
            </svg>
        </button>
        <button id="exportCombinedSvgBtn" class="toolbar-btn" title="Export Combined SVG">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <!-- Filled Triangle -->
                <g fill="currentColor" fill-opacity="0.7">
                    <path
                        d="M 12.38,2.08 V 8.92 L 6.58,12.98 C 6.05,12.35 6.02,11.4 6.61,10.34 L 8.55,6.86 10.37,3.58 c 0.55,-0.99 1.28,-1.5 2.01,-1.5 z" />
                    <path opacity="0.6"
                        d="m 18.19,12.98 c -0.4,0.49 -1.1,0.78 -2.04,0.78 H 8.62 c -0.94,0 -1.64,-0.29 -2.04,-0.78 L 12.38,8.92 Z" />
                    <path opacity="0.4"
                        d="M 18.19,12.98 12.38,8.92 V 2.08 c 0.73,0 1.46,0.5 2.01,1.5 l 1.82,3.28 1.94,3.48 c 0.59,1.06 0.56,2.01 0.03,2.64 z" />
                </g>
                <!-- Wireframe on top -->
                <path
                    d="m 12.18,14.06 h -3.77 c -2.16,0 -3.06,-1.54 -2.02,-3.43 L 8.34,7.14 10.16,3.85 c 1.11,-2 2.92,-2 4.03,0 l 1.83,3.29 1.94,3.5 c 1.04,1.88 0.14,3.42 -2.02,3.42 h -3.77 z"
                    stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                    fill="none" />
                <!-- Download Arrow -->
                <g stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none">
                    <path d="m 3.18,16.07 v 4 c 0,1.1 0.9,2 2,2 H 19.19 c 1.1,0 2,-0.9 2,-2 v -4" />
                    <path d="m 9.26,16.35 2.91,2.91 c 0.05,0.05 0.13,0.05 0.17,0 l 2.91,-2.91" />
                </g>
            </svg>
        </button>

        <div class="separator"></div>

        <button id="clearAllBtn" class="toolbar-btn" title="Reset (remove all triangles)">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M0 0h24v24H0z" fill="none" />
                <path
                    d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z" />
            </svg>
        </button>
        <button id="helpBtn" class="toolbar-btn" title="Help (?)">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path d="M0 0h24v24H0z" fill="none" />
                <path
                    d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z" />
            </svg>
        </button>
    </div>
    <canvas id="imageCanvas"></canvas>
    <div id="notification"></div>

    <div id="helpModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>How to Use Triangulator</h2>

            <h3>General</h3>
            <ul>
                <li><strong>Show this help dialog:</strong> Press <code>?</code></li>
            </ul>

            <h3>File Operations</h3>
            <ul>
                <li><strong>Open Image:</strong> Load a new background image. This will reset the current mesh.</li>
                <li><strong>Import/Export Mesh:</strong> Save your work (vertices and triangle connections) as a
                    <code>.json</code> file. This allows you to continue working on a mesh later. You must load the same
                    background image first.</li>
                <li><strong>Export as PNG/SVG:</strong> Export the final triangulated image in various formats for use
                    in other applications.</li>
                <li><strong>Reset:</strong> Remove all triangles from the canvas.</li>
            </ul>

            <h3>Navigation</h3>
            <ul>
                <li><strong>Pan:</strong> Click and drag the canvas with the left mouse button, or use a two-finger
                    swipe on a trackpad.</li>
                <li><strong>Zoom:</strong> Use <code>Ctrl</code> + Mouse Wheel, or pinch-to-zoom on a trackpad.</li>
            </ul>

            <h3>Triangle Creation</h3>
            <ul>
                <li>Click on an empty area to add a new vertex.</li>
                <li>Click near an existing vertex to snap to it.</li>
                <li><strong>Create a triangle in 3 ways:</strong>
                    <ol>
                        <li>Click three vertices in sequence.</li>
                        <li>Click an existing edge, then click a third vertex.</li>
                        <li>Click a single vertex, then click an existing edge.</li>
                    </ol>
                </li>
                <li><strong>Cancel creation:</strong> Press <code>Escape</code> or right-click. You can also click a
                    selected edge again to deselect it.</li>
            </ul>

            <h3>Modifying the Mesh</h3>
            <ul>
                <li><strong>Move Vertex:</strong> Click and drag an existing vertex to a new position.</li>
                <li><strong>Remove Triangle:</strong> Right-click on a triangle to remove it. A red overlay will
                    indicate which triangle will be removed.</li>
            </ul>

            <h3>History</h3>
            <ul>
                <li><strong>Undo:</strong> <code>Ctrl + Z</code></li>
                <li><strong>Redo:</strong> <code>Ctrl + Y</code></li>
            </ul>

            <h3>Visibility & Shortcuts</h3>
            <ul>
                <li><strong>Toggle Image:</strong> <code>1</code></li>
                <li><strong>Toggle Filled Triangles:</strong> <code>2</code></li>
                <li><strong>Toggle Wireframe:</strong> <code>3</code></li>
            </ul>

            <h3>Constraints (Invalid Actions)</h3>
            <p>The tool will prevent you from creating an invalid mesh. You cannot:</p>
            <ul>
                <li>Create a new vertex inside an existing triangle.</li>
                <li>Create triangles with edges that cross, or that overlap/engulf other triangles.</li>
                <li>Drag a vertex to a position that would cause an invalid mesh. The move will be reverted.</li>
            </ul>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>